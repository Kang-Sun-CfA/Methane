function outp = F_PS2PL_ab(inp)
% this function recovers full pressure grid from
% surface pressure using ak and bk from oco2 l2_met data
% ak and bk from geos chem wiki cannot reproduce geos fp PL from PS:
% http://wiki.seas.harvard.edu/geos-chem/index.php/GEOS-Chem_vertical_grids#72-layer_vertical_grid
% updated on 2019/04/15
PS = inp.PS;
ak = [1.5000000;2.6349998;4.0142498;5.6792498;7.7672501;10.452400;13.959900;18.542198;24.493750;32.178349;42.042351;54.629250;70.595650;90.728699;115.99751;147.56500;186.78799;235.25903;294.83209;367.65009;456.16861;563.18011;691.83215;845.63916;1028.4922;1246.0151;1505.0253;1812.4353;2176.1003;2604.9106;3108.8906;3699.2705;4390.9658;5201.5908;6149.5659;7255.7861;8543.9023;10051.438;11825.002;13911.502;16366.152;18906.102;20902.852;22061.402;22413.051;22133.699;21546.297;20770.449;19817.797;18735.797;17561.396;16293.446;14958.495;13580.294;12382.728;11407.016;10427.346;9423.2568;8396.7070;7472.8096;6749.2305;6120.7920;5487.4658;4851.7559;4216.0508;3577.6409;2933.1406;2285.2556;1637.3954;986.42773;332.09000;2.4024000];
bk = [0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0.0035000001;0.017500000;0.045850001;0.088650003;0.13490000;0.17829999;0.22354999;0.27055001;0.31889999;0.36815000;0.41829997;0.46915001;0.52045000;0.56365001;0.59840000;0.63320005;0.66824996;0.70354998;0.73530000;0.75999999;0.78125000;0.80260003;0.82400000;0.84535003;0.86669999;0.88814998;0.90964997;0.93115002;0.95265001;0.97420001;0.99250001];
% ak = [0.000000d+00, 4.804826d-02, 6.593752d+00, 1.313480d+01, 1.961311d+01, 2.609201d+01,...
%     3.257081d+01, 3.898201d+01, 4.533901d+01, 5.169611d+01, 5.805321d+01, 6.436264d+01,...
%     7.062198d+01, 7.883422d+01, 8.909992d+01, 9.936521d+01, 1.091817d+02, 1.189586d+02,...
%     1.286959d+02, 1.429100d+02, 1.562600d+02, 1.696090d+02, 1.816190d+02, 1.930970d+02,...
%     2.032590d+02, 2.121500d+02, 2.187760d+02, 2.238980d+02, 2.243630d+02, 2.168650d+02,...
%     2.011920d+02, 1.769300d+02, 1.503930d+02, 1.278370d+02, 1.086630d+02, 9.236572d+01,...
%     7.851231d+01, 6.660341d+01, 5.638791d+01, 4.764391d+01, 4.017541d+01, 3.381001d+01,...
%     2.836781d+01, 2.373041d+01, 1.979160d+01, 1.645710d+01, 1.364340d+01, 1.127690d+01,...
%     9.292942d+00, 7.619842d+00, 6.216801d+00, 5.046801d+00, 4.076571d+00, 3.276431d+00,...
%     2.620211d+00, 2.084970d+00, 1.650790d+00, 1.300510d+00, 1.019440d+00, 7.951341d-01,...
%     6.167791d-01, 4.758061d-01, 3.650411d-01, 2.785261d-01, 2.113490d-01, 1.594950d-01,...
%     1.197030d-01, 8.934502d-02, 6.600001d-02, 4.758501d-02, 3.270000d-02, 2.000000d-02,...
%     1.000000d-02];
% 
% bk = [1.000000d+00, 9.849520d-01, 9.634060d-01, 9.418650d-01, 9.203870d-01, 8.989080d-01,...
%     8.774290d-01, 8.560180d-01, 8.346609d-01, 8.133039d-01, 7.919469d-01, 7.706375d-01,...
%     7.493782d-01, 7.211660d-01, 6.858999d-01, 6.506349d-01, 6.158184d-01, 5.810415d-01,...
%     5.463042d-01, 4.945902d-01, 4.437402d-01, 3.928911d-01, 3.433811d-01, 2.944031d-01,...
%     2.467411d-01, 2.003501d-01, 1.562241d-01, 1.136021d-01, 6.372006d-02, 2.801004d-02,...
%     6.960025d-03, 8.175413d-09, 0.000000d+00, 0.000000d+00, 0.000000d+00, 0.000000d+00,...
%     0.000000d+00, 0.000000d+00, 0.000000d+00, 0.000000d+00, 0.000000d+00, 0.000000d+00,...
%     0.000000d+00, 0.000000d+00, 0.000000d+00, 0.000000d+00, 0.000000d+00, 0.000000d+00,...
%     0.000000d+00, 0.000000d+00, 0.000000d+00, 0.000000d+00, 0.000000d+00, 0.000000d+00,...
%     0.000000d+00, 0.000000d+00, 0.000000d+00, 0.000000d+00, 0.000000d+00, 0.000000d+00,...
%     0.000000d+00, 0.000000d+00, 0.000000d+00, 0.000000d+00, 0.000000d+00, 0.000000d+00,...
%     0.000000d+00, 0.000000d+00, 0.000000d+00, 0.000000d+00, 0.000000d+00, 0.000000d+00,...
%     0.000000d+00];
% ak = fliplr(ak);
% bk = fliplr(bk);
outp.ak = ak;
outp.bk = bk;
nlayer = length(ak);outp.nlayer = nlayer;
PL = nan(size(PS,1),size(PS,2),nlayer);
for ilayer = 1:nlayer
    PL(:,:,ilayer) = PS*bk(ilayer)+ak(ilayer);
end
outp.PL = squeeze(PL);
% PLEVEL = nan(size(PS,1),size(PS,2),nlevel,'single');
% for ilevel = 1:nlevel
%     PLEVEL(:,:,ilevel) = PS*bk(ilevel)+ak(ilevel);
% end
% for ilayer = 1:nlayer
%     PL(:,:,ilayer) = mean(PLEVEL(:,:,[ilayer,ilayer+1]),3);
% end
% outp.PL = PL;outp.PLEVEL = PLEVEL;
% 
